<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/mui.min.css" />
		<link rel="stylesheet" type="text/css" href="css/icons-extra.css" />
		<link rel="stylesheet" type="text/css" href="css/main.css" />
		<link rel="stylesheet" type="text/css" href="css/balance.css" />
	</head>
	<body>
		<div class="mui-content">
			<div id="mai"></div>
			<a href="#" id="load_Balanc" class="mui-icon mui-icon-reload"></a>
	    		<div id="legen">
<!-- 	    			<div class="legendText"><span style="color: #F67D00">◼︎</span>3620.24 USD</div> -->
	    			<!--<div class="legendText"><span style="color: #19C3B2">◼</span>744.80 CNY</div>-->
	    		</div>			
		<!--<div class="mui-card" style="margin-bottom: 20px;">
			<div class="mui-card-header">總資產

			</div>
				<div class="mui-card-content">
					<div class="mui-card-content-inner" id="result_message">
					
					</div>
					
					<ul class="mui-table-view" id="history">
					</ul>
				
				</div>
				
			</div>
		</div>-->
		
			<!--<div class="title">Active</div>
			<ul class="mui-table-view" id="history">
			</ul>-->
	
	</body>
	<script src="https://tradewise.technology/webapp/js/lodash.js"></script>
	<script src="js/mui.min.js"></script>
	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/common.js"></script>
	<script type="text/javascript" src="js/ripple-0.17.4-min.js"></script>
	<script type="text/javascript" src="js/tradewise_api.js"></script>
	<script type="text/javascript" src="js/echarts-all.js"></script>
<!-- 	<script>
   		mui.init({
			swipeBack: false,
			
		});
		mui.plusReady(function(){
			var dataDict = [];
			load_balance();
			//load_balance2();
			
			var account = localStorage.getItem('address');
			//var secret = localStorage.getItem('secret');
			//initial
			
		    
			//触发submit按钮的点击事件
			//mui.trigger(btn,'tap');
			//添加newId自定义事件监听
			
			var refreshbtn = document.getElementById("load_Balance");
			refreshbtn.addEventListener("tap",function () {
				load_balance();
				//load_balance2();
			});
			
			var self = plus.webview.currentWebview();
			window.addEventListener('refresh',function(event){   //监听自定义事件
		        self.reload();
		    });
			
			
			
			
			dataDict = [{value:24943},{value:744}];
//			function load_balance2(){
//	    			
//				document.getElementById("result_message").innerHTML += '<div class="loader"><a><span class="mui-spinner"></span></a><br /><span>載入中...</span></div>';
//				console.log(ripple);
//			    var api = new ripple.RippleAPI({server:'wss://s.altnet.rippletest.net:51233'});
//			    	api.connect().then(function() {
//			        return api.getBalanceSheet(address);
//			    }).then(function(balanceSheet) {
//			    		//console.log(JSON.stringify(balances));
//			    		//document.getElementById("result_message").innerHTML = "";
//			    		console.log(JSON.stringify(balanceSheet));
//			    		for(var i = 0; i<= balanceSheet.assets.length; i++){
//			    			console.log(balanceSheet.assets[i].currency);
//			    			document.getElementById("result_message").innerHTML += balanceSheet.assets[i].value + " " + balanceSheet.assets[i].currency+"";
//			    		}
//			    });
//			}
			
			var 	color = ["#F67D00", "#19C3B2", "#0CA4FF", "#FF5B5B", "#EAD83D", "#C4B4E4","#DF9499","#A3ACC2"];
	        var myChart = echarts.init(document.getElementById('main'));   
//	        dataDict = [{value:100,name:"hello"}];
			var option = {
	            color : color,
	        	 title : {
	                text: '總資產',
	                x : 'center',
	                y : 'center',
	                textStyle : {
	                	fontSize : 28,
	                	fontFamily : "sans-serif"
	                }
	            },
	            series : [
	                {
	                    name:'總資產',
	                    type:'pie',
	                    center : ['50%', '50%'],
	                    radius : ['60%', '70%'],
	                    itemStyle : {
	                        normal : {
	                            label : {
	                                show : false
	                            },
	                            labelLine : {
	                                show : false
	                            }
	                        }
	                    },
	                    data: dataDict
	                    
	                }
	            ]
	       };
        		myChart.setOption(option);
			//监听点击事件
			
			/*
			refreshbtn.addEventListener("tap",function () {
			  	document.getElementById("result_message").innerHTML = '';
			  	api.connect().then(function() {
			        return api.getBalances(account);
			    }).then(function(balances) {
			    		//console.log(JSON.stringify(balances));
			    		for(var i = 0; i<= balances.length; i++){
			    			document.getElementById("result_message").innerHTML += balances[i].currency + " " + balances[i].value+"<br/>";
			    		}
			    });
			});*/

			//添加newId自定义事件监听
			/*
			window.addEventListener('reload_after_done',function(event){
			  //获得事件参数
			  //console.log('aaa');
			  
			  //使用方法
			  //var balancewebview = plus.webview.getWebviewById('balance.html');
			  //mui.fire(balancewebview, 'refresh', {});
			 	
			 	document.getElementById("result_message").innerHTML = "載入中...";
				console.log(ripple);
			    var api = new ripple.RippleAPI({server:'wss://s.altnet.rippletest.net:51233'});
			    	api.connect().then(function() {
			        return api.getBalances(account);
			    }).then(function(balances) {
			    		document.getElementById("result_message").innerHTML = "";
			    		//console.log(JSON.stringify(balances));
			    		for(var i = 0; i<= balances.length; i++){
			    			document.getElementById("result_message").innerHTML += balances[i].currency + " " + balances[i].value+"<br/>";
			    		}
			    });
			    
			});
			*/
			
		});
		function load_balance(){
				var 	color = ["#F67D00", "#19C3B2", "#0CA4FF", "#FF5B5B", "#EAD83D", "#C4B4E4","#DF9499","#A3ACC2"];
				
//				document.getElementById("legend").innerHTML = '<div class="loader mui-text-center"><a><span class="mui-spinner"></span></a><br /><span>載入中...</span></div>';
//				console.log(ripple);
	   			var api = new ripple.RippleAPI({server:'wss://s.altnet.rippletest.net:51233'});
			    	api.connect().then(function() {
			        return api.getBalanceSheet(address);
			        
			    }).then(function(balanceSheet) {
					document.getElementById("legend").innerHTML = '';
			    		for(var i = 0; i<= balances.length; i++){
			    			if( balances[i].currency != "XRP" ){
			    				var num = new Number(balances[i].value);
			    				document.getElementById("legend").innerHTML += '<div class="legendText"><span class="mui-icon" style="color:' + color[i-1] +'">◼︎</span>'+ num.toFixed(2) + ' ' + balances[i].currency + '</div>';
			    				dataDict.push({value:num.toFixed(0)});
			    				console.log(JSON.stringify(dataDict));
			    			}
			    			
			    		}
//			    		console.log("hello"+JSON.stringify(dataDict));
			    });
			}
      </script> -->

</html>